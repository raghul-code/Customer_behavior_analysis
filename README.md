# Customer_behavior_analysis
Data analytics project for customer behavior using Python,SQL,power BI

## 1.Used df.info() to check structure and .describe() for summary statistics. 
'''python
df.info()
'''
## 2.Created age_group column by binning customer ages. 
'''python
labels = ['Young Adult','Adult','Middle-aged','Senior']

df['age_group'] = pd.qcut(df['age'],q=4,labels=labels)
'''
## 3.Created purchase_frequency_days column from purchase data. 
'''python
frequency_days = {
    'Fortnightly':14,
    'Weekly':7,
    'Monthly':30,
    'Quartely':90,
    'Bi-Weekly':14,
    'Annually':365,
    'Every 3 Months':90
}
df['purchase_frequency_days'] = df['frequency_of_purchases'].map(frequency_days)
'''


##1. Total revenue generated by male vs female customers
'''sql 
SELECT SUM(purchase_amount_usd) AS total_revenue, gender
FROM dbo.Cleaned_Customer_Data
GROUP BY gender;
'''

##2. Customers who used discounts but spent more than average
'''sql
SELECT customer_id, purchase_amount_usd
FROM dbo.Cleaned_Customer_Data
WHERE discount_applied = 'Yes'
  AND purchase_amount_usd >= (
    SELECT AVG(purchase_amount_usd)
    FROM dbo.Cleaned_Customer_Data
  );
'''

##3. Top 5 products with highest average review rating

'''sql
SELECT TOP(5) item_purchased, AVG(review_rating) AS average_product_rating
FROM dbo.Cleaned_Customer_Data
GROUP BY item_purchased
ORDER BY AVG(review_rating) DESC;
'''
##4. Compare average purchase amounts between Standard and Express shipping
'''sql
SELECT shipping_type, AVG(purchase_amount_usd) AS avg_amount
FROM dbo.Cleaned_Customer_Data
WHERE shipping_type IN ('Express', 'Standard')
GROUP BY shipping_type;
'''
##5. Subscriber vs Non-Subscriber spending comparison
'''sql
SELECT subscription_status,
       COUNT(customer_id) AS no_of_customers,
       AVG(purchase_amount_usd) AS average_amount,
       SUM(purchase_amount_usd) AS total_revenue
FROM dbo.Cleaned_Customer_Data
GROUP BY subscription_status;
'''
##6. Top 5 products with highest percentage of discounted purchases
'''sql
SELECT TOP 5 item_purchased,
       (100 * SUM(CASE WHEN discount_applied = 'Yes' THEN 1 ELSE 0 END) / COUNT(*)) AS discount_rate
FROM dbo.Cleaned_Customer_Data
GROUP BY item_purchased
ORDER BY discount_rate DESC;
'''
##7. Segment customers into New, Returning, and Loyal
'''sql
WITH customer_type AS (
  SELECT customer_id, previous_purchases,
         CASE
           WHEN previous_purchases <= 1 THEN 'new_customer'
           WHEN previous_purchases BETWEEN 2 AND 10 THEN 'returning'
           ELSE 'loyal'
         END AS customer_loyalty
  FROM dbo.Cleaned_Customer_Data
)
SELECT customer_loyalty, COUNT(*) AS number_of_customers
FROM customer_type
GROUP BY customer_loyalty
ORDER BY number_of_customers ASC;
'''
##8. Top 3 most purchased products within each category
'''sql
WITH item_counts AS (
  SELECT category, item_purchased, COUNT(customer_id) AS total_orders,
         ROW_NUMBER() OVER (PARTITION BY category ORDER BY COUNT(customer_id) DESC) AS item_rank
  FROM dbo.Cleaned_Customer_Data
  GROUP BY category, item_purchased
)
SELECT item_rank, category, item_purchased, total_orders
FROM item_counts
WHERE item_rank <= 3;
'''
##9. Are repeat buyers (>5 purchases) more likely to subscribe?
'''sql
SELECT subscription_status, COUNT(customer_id) AS total_customers
FROM dbo.Cleaned_Customer_Data
WHERE previous_purchases > 5
GROUP BY subscription_status;
'''
##10. Revenue contribution by age group
'''sql
SELECT COUNT(customer_id) AS number_of_customers,
       age_group,
       SUM(purchase_amount_usd) AS total_revenue
FROM dbo.Cleaned_Customer_Data
GROUP BY age_group;
'''

